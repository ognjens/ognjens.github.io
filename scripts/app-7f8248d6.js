!function(){"use strict";angular.module("dashboard",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","pascalprecht.translate","LocalStorageModule","atomic-notify"])}(),function(){"use strict";function a(a,e,n,t,o,i,r){var s={"Content-Type":"application/json",Accept:"*"};return{ajax:function(l,c,d,u,p){t.get("user_id")&&(s["x-user"]=t.get("user_id")),t.get("auth_token")&&(s["x-auth-token"]="Bearer "+t.get("auth_token"));var m=_.isUndefined(p)||_.isNull(p)?"":p,g=_.isUndefined(s)||_.isNull(s)?[]:s;e({withCredentials:!1,method:l,url:n+c,headers:g,data:m}).success(function(e){a.log("Successful AJAX call."),a.log(e),d(e)}).error(function(e){a.log("Ajax error"),a.log(e),u?u(e):(o.error(i("translate")("SERVER_ERROR")),(_.isNull(e)||e.meta&&401===e.meta.code)&&(t.clearAll(),r.go("login")))})},post:function(a,e,n,t){return this.ajax("POST",a,n,t,e)},put:function(a,e,n,t){return this.ajax("PUT",a,n,t,e)},get:function(a,e,n){return this.ajax("GET",a,e,n)},"delete":function(a,e,n){return this.ajax("DELETE",a,e,n)}}}a.$inject=["$log","$http","apiUrl","localStorageService","atomicNotifyService","$filter","$state"],angular.module("dashboard").service("xHttp",a)}(),function(){"use strict";function a(a,e,n){function t(a,t,o){n.post("/user_session",a,function(a){a.auth_token&&a.user_id?(e.set("auth_token",a.auth_token),e.set("user_id",a.user_id),t()):o()},o)}function o(){n.delete("/user_session",function(){}),e.clearAll(),r={}}function i(a,t){r?a(r):n.get("/user_session",function(n){n.meta&&n.meta.code&&200===n.meta.code?(e.set("permissions",n.data.permissions),r=n.data,a(r)):t()},t)}var r={};return{loginUser:t,logOutUser:o,getUser:i}}a.$inject=["$log","localStorageService","xHttp"],angular.module("dashboard").factory("userSingleton",a)}(),function(){"use strict";function a(a){var e={restrict:"A",link:function(e,n){e.$watch("authentication.user",function(){a(function(){n.metisMenu()})})}};return e}a.$inject=["$timeout"],angular.module("dashboard").directive("sideNavigation",a)}(),function(){"use strict";function a(a,e){var n=[],t=function(){try{n=angular.fromJson(e.get("permissions"))}catch(t){a.log(t),n=[]}};return t(),{isAllowed:function(a){return n||t(),"admin"===n[0]?!0:!(a&&!_.contains(n,a))},resetPermissions:function(){n=null}}}a.$inject=["$log","localStorageService"],angular.module("dashboard").service("permissionStatus",a)}(),function(){"use strict";function a(a){var e={restrict:"A",link:function(e,n,t){var o=t.permissionNeeded;a.isAllowed(o)||n.hide()}};return e}a.$inject=["permissionStatus"],angular.module("dashboard").directive("permissionNeeded",a)}(),function(){"use strict";function a(a){return{restrict:"A",template:'<a class="navbar-minimalize minimalize-styl-2 btn btn-primary "href="" data-ng-click="minimalize()"><i class="fa fa-bars"></i></a>',controller:["$scope","$element","localStorageService",function(e,n,t){_.isNull(t.get("collapse"))?t.set("collapse",!1):t.get("collapse")&&angular.element("body").toggleClass("mini-navbar"),e.minimalize=function(){t.get("collapse")?t.set("collapse",!1):t.set("collapse",!0),angular.element("body").toggleClass("mini-navbar"),!angular.element("body").hasClass("mini-navbar")||angular.element("body").hasClass("body-small")?(angular.element("#side-menu").hide(),a(function(){angular.element("#side-menu").fadeIn(400)},200)):angular.element("#side-menu").removeAttr("style")}}]}}a.$inject=["$timeout"],angular.module("dashboard").directive("minimalizaSidebar",a)}(),function(){"use strict";function a(){var a=function(a,e,n,t){this.id=a,this.href="/"+this.id;var o=this.id,i=this.id;this.contentUrl="app/"+o+"/"+i+"/"+i+".html",this.neededPermission=t,this.icon=n,this.name=e};this.items=[new a("dashboard","DASHBOARD","dashboard","dashboard"),new a("contacts","CONTACTS","list","contacts_view_all")],this.$get=function(){return{items:this.items}}}angular.module("dashboard").provider("menu",a)}();var SR={WELCOME_TO_DASHBOARD:"Dobrodošli na Zaria Kontrol panel",ENTER_YOUR_LOGIN_DETAILS:"Unesite vaše podate za prijavljivanje!",USERNAME:"Korisničko ime",PASSWORD:"Lozinka",LOGIN:"Prijavite se",LOGIN_FAILD:"Vaš pokušaj da se ulogujete nije bio uspešan. Molimo Vas pokušajte ponovo."},EN={};angular.module("dashboard").controller("ScanRamqCtrl",["$log","$scope","$state","$timeout","$rootScope","localStorageService",function(a,e,n,t,o,i){function r(a){var n,t;a.stopPropagation(),a.preventDefault(),n=a.clipboardData||window.clipboardData,t=n.getData("Text"),e.ramqNumber=t,e.submit()}var s=/[A-Za-z]{4}\d{8}/;return e.forgot=!1,e.forgotShow=!1,e.submit=function(){var a={ramq:"Please enter a RAMQ number",format:"Invalid RAMQ number format"};if("FR"==i.get("language"))var a={ramq:"S'il vous plaît entrer votre numéro de RAMQ",format:"Format de numéro RAMQ non valide"};e.ramqNumber?e.ramqNumber.length<11?errorAlert(a.ramq):s.test(e.ramqNumber)?(e.prepopulate={ramq:e.ramqNumber,year:e.ramqNumber.slice(4,6),month:e.ramqNumber.slice(6,8),day:e.ramqNumber.slice(8,10),noRAMQ:!1},i.set("prepopulate",e.prepopulate),n.go("main"==i.get("scan")?"new-user-info":"new-profile-info")):errorAlert("number format wrong"):errorAlert(a.ramq)},e.scanType=i.get("scan"),e.skipStep=function(){e.prepopulate={ramq:"",year:"",month:"",day:"",noRAMQ:!0},i.set("prepopulate",e.prepopulate),n.go("main"==i.get("scan")?"new-user-info":"new-profile-info")},e.clickOnScan=function(){$("#scanInput").prop("readonly",!1)},t(function(){$("#scanInput").trigger("focus")},200),e.$watch("scanValue",function(a){e.showButton=s.test(a)?!0:!1}),document.getElementById("scanInput").addEventListener("paste",r),e.turnOnScanner=function(){window.kp_padlockScan_start()},window.kp_padlockScan_scanningDidFinish=function(a,n){e.ramqNumber=n,alert(e.ramqNumber),e.submitRAMQ()},e.submitRAMQ=function(){e.showLoader=!0,t(function(){e.showLoader=!1,n.go("appointments")},2e3)},e.showForgot=function(){e.forgot=!0,e.forgotShow=!0},e}]),angular.module("dashboard").controller("MainCtrl",["$log","$scope","xHttp","$timeout","userSingleton","$state","localStorageService","$rootScope","$window",function(a,e){a.log("Main Controller"),e.app={logged:!1,loginFaild:!1,loginBtn:!1,search:""},e.goBack=function(){window.history.back()},e.closeCancel=function(){e.closing=!1},e.closeModal=function(){e.closing=!0}}]),angular.module("dashboard").controller("LanguageCtrl",["$scope","localStorageService","$state",function(a,e,n){a.selectLang=function(a){e.set("language",a),n.go("scan-ramq")}}]),angular.module("dashboard").controller("LandingCtrl",["$scope",function(a){a.turnOnScanner=function(){window.kp_padlockScan_start()}}]),angular.module("dashboard").controller("HomeCtrl",["$log","$scope","menu","version",function(a,e,n,t){a.log("Home Controller"),e.current_year=moment().format(),e.menu=n,e.version=t}]),angular.module("dashboard").controller("FormCtrl",["$scope","localStorageService","$state",function(){console.log("form")}]),angular.module("dashboard").factory("ClinicsFactory",["$log","$http","$q","apiUrl","AuthService","localStorageService",function(a,e,n,t,o){function i(){var a=o.getCurrentUser();return a?e({method:"GET",url:[t,"profile"].join("/"),headers:{Authorization:"Bearer "+a.token}}).then(function(a){return a.data&&(AccountInfo=a.data.data),n.resolve(AccountInfo)},function(){n.reject("Argument is missing")}):void n.reject("User is not logged")}function r(){return a.info("MyProfileService:: get clinic name from subdomain"),e({method:"GET",url:t,headers:{"Content-Type":"application/json",Authorization:"Bearer "+o.getToken()}}).then(function(a){return a.data.data}).catch(function(a){return n.reject(a)})}var s={show:i,getClinicName:r};return s}]),angular.module("dashboard").factory("AuthService",["$q","LocalStorage",function(a,e){function n(a){console.log("AuthService.login",a),d=a,e.set(c,a)}function t(){d=null,e.set(c,null)}function o(a){return angular.isArray(a)||(a=[a]),i()&&-1!==a.indexOf(d.role)}function i(){return!!d}function r(){return d}function s(){if(d&&d.token)return d.token;var a=new Date,e=a.getMonth()+1,n=a.getDate();10>e&&(e="0"+e),10>n&&(n="0"+n);var t=sjcl.hash.sha256.hash("tapmedical"+a.getFullYear()+"-"+e+"-"+n),o=sjcl.codec.hex.fromBits(t);return console.log("tapmedical"+a.getFullYear()+"-"+e+"-"+n),o}var l={login:n,logout:t,isAuthorized:o,isAuthenticated:i,getCurrentUser:r,getToken:s},c="currentUser",d=e.get(c);return l}]),angular.module("dashboard").controller("DashboardCtrl",["$log",function(a){a.log("Dashboard Controller")}]),angular.module("dashboard").controller("ConfirmCtrl",["$scope","localStorageService","$state",function(a){a.hideBack=!0}]),angular.module("dashboard").controller("AppointmentsCtrl",["$scope","localStorageService","$state",function(a,e,n){a.selectLang=function(a){e.set("language",a),n.go("home")},a.notMyAppt=function(){a.forgot=!0,a.wrongAppt=!0}}]),$(document).ready(function(){function a(){var a=$("body > #wrapper").height()-61;$(".sidebard-panel").css("min-height",a+"px");var e=$("nav.navbar-default").height(),n=$("#page-wrapper").height();e>n&&$("#page-wrapper").css("min-height",e+"px"),n>e&&$("#page-wrapper").css("min-height",$(window).height()+"px"),$("body").hasClass("fixed-nav")&&(e>n?$("#page-wrapper").css("min-height",e-60+"px"):$("#page-wrapper").css("min-height",$(window).height()-60+"px"))}$(window).bind("load resize scroll",function(){$("body").hasClass("body-small")||a()}),setTimeout(function(){a()},500)}),$(function(){$(window).bind("load resize",function(){$(this).width()<769?$("body").addClass("body-small"):$("body").removeClass("body-small")})}),function(){"use strict";function a(a,e,n,t,o){a.debug("runBlock end"),_.isNull(o.get("language"))&&o.set("language","EN"),e.use(o.get("language"))}a.$inject=["$log","$translate","$rootScope","$state","localStorageService"],angular.module("dashboard").run(a)}(),function(){"use strict";function a(a,e){a.state("landing",{url:"/landing",templateUrl:"app/landing/landing.html",controller:"LandingCtrl"}).state("home",{url:"/",templateUrl:"app/common/content.html"}).state("home.dashboard",{url:"/dashboard",templateUrl:"app/dashboard/dashboard.html",controller:"DashboardCtrl"}).state("appointments",{url:"/appointments",templateUrl:"app/appointments/appointments.html",controller:"AppointmentsCtrl"}).state("scan-ramq",{url:"/scan-ramq",templateUrl:"app/scan-ramq/scan-ramq.html",controller:"ScanRamqCtrl"}).state("form",{url:"/form",templateUrl:"app/form/form.html",controller:"FormCtrl"}).state("confirm",{url:"/confirm",templateUrl:"app/confirm-screen/confirm.html",controller:"ConfirmCtrl"}).state("language",{url:"/language",templateUrl:"app/language/language.html",controller:"LanguageCtrl"}),e.otherwise("/landing")}a.$inject=["$stateProvider","$urlRouterProvider"],angular.module("dashboard").config(a)}(),function(){"use strict";angular.module("dashboard").constant("version","1.0.0")}(),function(){"use strict";angular.module("dashboard").constant("apiUrl","../api").constant("version","1.0.0")}(),function(){"use strict";function a(a,e,n){a.debugEnabled(!0),e.translations("EN",EN),e.translations("SR",SR),e.preferredLanguage("SR"),e.useSanitizeValueStrategy(null),n.setDefaultDelay(2500),n.useIconOnNotification(!0)}a.$inject=["$logProvider","$translateProvider","atomicNotifyProvider"],angular.module("dashboard").config(a)}(),angular.module("dashboard").run(["$templateCache",function(a){a.put("app/appointments/appointments.html",'<div class="text-center page-wrapper apptsScreen"><div ng-include="\'app/common/small-header.html\'"></div><div class="animated fadeInRight"><div class="text-container appts-container"><p class="big-text">Hi Andrew!</p><h3 ng-hide="late">We found your appointment.</h3><h3 ng-show="late">We found your appointment, but it looks like you’re running a little late.</h3><div class="single-box single-appt {{late == true ? \'late\' : \'\'}}"><div class="top"><p class="time">11:30</p><p class="date">Today, Friday April 13</p></div><div class="doctor"><p class="doctor-name">Dr Tsafrir Vanounou</p><p class="specialty">Family medicine</p></div></div></div><div class="right-float" ng-hide="late"><a class="round-button" href="javascript:void(0)" ng-click="" ui-sref="form"></a><p class="purple">Continue</p></div></div><div class="bottom"><a href="javascript:void(0)" ng-show="late" ui-sref="landing" class="button">Close</a> <a href="javascript:void(0)" class="button" ng-click="notMyAppt()" ng-hide="late">This isn’t my appointment</a></div></div>'),a.put("app/common/content.html",'<div id="wrapper"><div ng-include="\'app/common/navigation.html\'"></div><div id="page-wrapper" class="gray-bg {{$state.current.name}}"><div ng-include="\'app/common/topnavbar.html\'"></div><div ui-view=""></div><div ng-include="\'app/common/footer.html\'"></div></div></div>'),a.put("app/common/footer.html",'<div class="footer"><div class="pull-right">10GB of <strong>250GB</strong> Free.</div><div><strong>Copyright</strong> Example Company &copy; 2015-2016</div></div>'),a.put("app/common/ibox_tools.html",'<div class="ibox-tools" uib-dropdown=""><a ng-click="showhide()"><i class="fa fa-chevron-up"></i></a> <a uib-dropdown-toggle="" href=""><i class="fa fa-wrench"></i></a><ul uib-dropdown-menu=""><li><a href="">Config option 1</a></li><li><a href="">Config option 2</a></li></ul><a ng-click="closebox()"><i class="fa fa-times"></i></a></div>'),a.put("app/common/navigation.html",'<nav class="navbar-default navbar-static-side" role="navigation"><div class="sidebar-collapse"><ul side-navigation="" class="nav metismenu" id="side-menu"><li class="nav-header"><div class="profile-element" uib-dropdown=""><a uib-dropdown-toggle="" href=""><span class="clear"><span class="block m-t-xs"><strong class="font-bold">{{main.userName}}</strong></span> <span class="text-muted text-xs block">Example menu<b class="caret"></b></span></span></a><ul uib-dropdown-menu="" class="animated flipInX m-t-xs"><li><a href="">Logout</a></li></ul></div><div class="logo-element">IN+</div></li><li ui-sref-active="active"><a ui-sref="index.main"><i class="fa fa-laptop"></i> <span class="nav-label">Main page</span></a></li><li ui-sref-active="active"><a ui-sref="index.minor"><i class="fa fa-desktop"></i> <span class="nav-label">Minor page</span></a></li></ul></div></nav>'),a.put("app/common/small-header.html",'<div class="row small-header"><nav class="navbar navbar-static-top white-bg" role="navigation"><a href="javascript:void(0)" class="header-back" ng-hide="hideBack" ng-click="goBack()"></a> <a href="javascript:void(0)" class="header-close" ng-hide="hideClose" ng-click="closeModal()"></a> <img src="../../assets/images/Tap_logo.svg" alt="clinic logo"></nav></div><div class="loader padding" ng-if="forgot"><img src="../../assets/images/Tap_logo.svg" alt="clinic logo"><div class="text-container"><h3 ng-if="forgotShow">Forgot your RAMQ card, or don’t have one?</h3><h3 ng-if="expiredShow">Your RAMQ card is expired</h3><h3 ng-if="noAppts">Oops, we couldn’t find your appointment</h3><h3 ng-if="wrongAppt">Oops, sorry about that.</h3><p class="big-text">Please check in with the receptionist.</p><a class="button" href="javascript:void(0)" ui-sref="landing">Close</a></div></div><div class="closing-modal confirmed" ng-if="closing"><a href="javascript:void(0)" class="closeModal" ng-click="closeCancel();"></a><h3>Are you sure you want to cancel check in?</h3><div class="buttons"><a href="javascript:void(0);" class="white button" ng-click="closeCancel();">No, Continue</a> <a href="javascript:void(0);" class="white button" ng-click="closeCancel();" ui-sref="landing">Yes, cancel</a></div></div>'),a.put("app/common/topnavbar.html",'<div class="row border-bottom"><nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0"><img src="../../assets/images/Tap_logo.svg" alt="clinic logo"> <img src="../../assets/images/clinic_logo_placeholder.png" alt="clinic logo"></nav></div>'),a.put("app/confirm-screen/confirm.html",'<div class="text-center page-wrapper apptsScreen confirmed"><div ng-include="\'app/common/small-header.html\'"></div><div class="animated fadeIn"><div class="medium-container"><img src="../../assets/images/Check.svg" class="check" alt=""><h3>You’re all set! You will be called in when your doctor is ready.</h3></div></div><div class="appsection"><div class="bottom-purple"><img src="../../assets/images/Iphone@4x.png" alt="phone"><h3>Receive live updates while you wait!</h3><p>Download Tap Medical on the app store or google play.</p><div class="apps"><a href="https://appsto.re/hr/QZmnjb.i" class="app"></a> <a href="https://play.google.com/store/apps/details?id=com.evolutionmedical.app&hl=en" class="play"></a></div></div></div></div>'),a.put("app/dashboard/dashboard.html",'<div class="wrapper wrapper-content animated fadeInRight"><div class="row"><div class="col-xs-12"><div class="ibox float-e-margins"><div class="ibox-title"><h5><i class="fa fa-history"></i> Dashboard</h5></div><div class="ibox-content"></div></div></div></div></div>'),a.put("app/form/form.html",'<div class="text-center page-wrapper apptsScreen"><div ng-include="\'app/common/small-header.html\'"></div><div class="animated fadeIn"><div class="text-container form-container"><h3>Last step! Please verify your info</h3><p class="big-text">Tap to edit</p><div class="inputs-holder"><label for="home">Home phone</label> <input type="tel" id="home" name="" ng-model="home" value=""> <label for="mobile">Cell</label> <input type="tel" name="" id="mobile" value="" ng-model="mobile"> <label for="email">Email</label> <input type="email" name="" value="" id="email" ng-model="email"><div class="addressField"><p>Address 1</p><p>Address 2</p><p>Address 3</p></div><a href="#" class="round-button" ui-sref="confirm"></a><p class="purple">Confirm and check-in</p></div></div></div></div>'),a.put("app/landing/landing.html",'<div class="text-center page-wrapper loginscreen" ng-init="turnOnScanner()"><div ng-include="\'app/common/topnavbar.html\'"></div><div class="animated fadeInUp"><div class="text-container"><h1 class="gray-underline">Enregistrement</h1><h1>Check-in</h1><a href="#" class="round-button" ui-sref="language"></a><p class="purple">Commencer / Start</p></div></div></div>'),a.put("app/language/language.html",'<div class="text-center page-wrapper apptsScreen"><div ng-include="\'app/common/small-header.html\'"></div><div class="animated slideInRight"><div class="medium-container"><div class="single-box" ng-click="selectLang(fr)"><p>Bienvenue</p><h3>Continuer en français</h3><a class="round-button inline"></a></div><div class="single-box" ng-click="selectLang(en)"><p>Welcome</p><h3>Continue in English</h3><a class="round-button inline"></a></div></div></div></div>'),a.put("app/scan-ramq/scan-ramq.html",'<div class="text-center page-wrapper apptsScreen" ng-init="turnOnScanner()"><div ng-include="\'app/common/small-header.html\'"></div><div class="animated fadeIn"><div class="medium-container text-center"><h2>Please scan your RAMQ card</h2><p class="big-text">Or tap to add it manually</p><form class="small-form scanRamqForm"><label for="">RAMQ Health Insurance Number</label> <input type="text" id="scanInput" name="" ng-model="scanValue" maxlength="12" value=""> <span class="not-good" ng-show="!showButton"></span> <span class="good" ng-show="showButton"></span></form><div class="right-float half" ng-show="showButton"><a class="round-button" href="javascript:void(0)" ng-click="submitRAMQ()"></a><p class="purple">Continue</p></div><img src="../../assets/images/Scan@2x.png" alt=""><div class="bottom-link"><p>If you forgot or don’t have a RAMQ card, <a href="javascript:void(0);" ng-click="showForgot()">Click here</a></p></div></div></div><div class="loader image" ng-if="showLoader"><img src="../../assets/images/Tap_logo.svg" alt="clinic logo"> <img src="../../assets/images/loader-purple.gif" class="featured-image" alt=""><div class="text-container"><h3>We’re looking for your appointments</h3></div></div></div>')}]);