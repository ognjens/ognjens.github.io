function graph(){var t=function(t,e,a){this.reference=a,this.$element=$(a),this.circle=$(e),this.index=t,this.canvasSize=null,this.centre=null,this.radius=null,this.startY=null,this.init()},e=t.prototype;e.init=function(){this.createChildren().enable()},e.createChildren=function(){return this.$ring=$(".js-graphItem"),this.canvas=Snap(this.reference),this},e.enable=function(){this.getValue()},e.setValues=function(){return this.canvasSize=this.$element.height(),this.centre=this.canvasSize/2,this.radius=.8*this.canvasSize/2-15*this.index,this.startY=this.centre-this.radius,this},e.getValue=function(){this.setValues();var t=this.circle.attr("data-val");t=parseInt(t,10);var e=t/100,a=this.circle.attr("data-color");this.animate(e,a)},e.animate=function(t,e){var a=this,i="",n=this.canvas.path(i),s=360*t;Snap.animate(0,s,function(t){n.remove(),i=a.formPath(t),n=a.canvas.path(i),n.attr({stroke:e,fill:"none",strokeWidth:15})},2e3,mina.easeinout)},e.formPath=function(t){var e,a=t,i=a-90,n=Math.PI*i/180,s=this.centre+this.radius*Math.cos(n),r=this.centre+this.radius*Math.sin(n),o=a>180?1:0;return e=99.99999999999999===s?"M"+this.centre+","+this.startY+" A"+this.radius+","+this.radius+" 0 "+o+",1 99.99999,"+r+" Z":"M"+this.centre+","+this.startY+" A"+this.radius+","+this.radius+" 0 "+o+",1 "+s+","+r},$(".js-graphItem").each(function(e,a){this.text=new t(e,a,"#svg")})}!function(t,e,a,i){"use strict";var n={version:"0.0.1",settings:{donut:!1,donut_inner_ratio:.4,percent_offset:35,stroke_color:"#333",stroke_width:0,show_percent:!0,animation_speed:500,animation_type:"elastic"},init:function(e,i){var n=this;this.scope=e||a.body;var s=t("[data-pie-id]",this.scope);t.extend(!0,this.settings,i),s.length>0?s.each(function(){return n.build(t(this),i)}):this.build(t(this.scope),i),this.events()},events:function(){var a=this;t(e).off(".pizza").on("resize.pizza",a.throttle(function(){a.init()},100)),t(this.scope).off(".pizza").on("mouseenter.pizaa mouseleave.pizza touchstart.pizza","[data-pie-id] li",function(e){var a=t(this).parent(),i=Snap(t("#"+a.data("pie-id")+' path[data-id="s'+t(this).index()+'"]')[0]),n=Snap(t(i.node).parent().find('text[data-id="'+i.node.getAttribute("data-id")+'"]')[0]),s=t(this).parent().data("settings");/start/i.test(e.type)&&t(i.node).siblings("path").each(function(){this.nodeName&&(i.animate({transform:"s1 1 "+i.node.getAttribute("data-cx")+" "+i.node.getAttribute("data-cy")},s.animation_speed,mina[s.animation_type]),Snap(t(this).next()[0]).animate({opacity:0},s.animation_speed))}),/enter|start/i.test(e.type)?(i.animate({transform:"s1.05 1.05 "+i.node.getAttribute("data-cx")+" "+i.node.getAttribute("data-cy")},s.animation_speed,mina[s.animation_type]),s.show_percent&&n.animate({opacity:1},s.animation_speed)):(i.animate({transform:"s1 1 "+i.node.getAttribute("data-cx")+" "+i.node.getAttribute("data-cy")},s.animation_speed,mina[s.animation_type]),n.animate({opacity:0},s.animation_speed))})},build:function(e,a){var i=this,n=e;return n.data("settings",t.extend({},i.settings,a,n.data("options"))),i.data(n,a||{}),i.update_DOM(i.pie(n))},data:function(e,a){var i=[];return t("li",e).each(function(){var e=t(this);a.data?i.push({value:a.data[e.index()],color:e.css("color"),segment:e}):i.push({value:e.data("value"),color:e.css("color"),segment:e})}),e.data("graph-data",i)},update_DOM:function(e){var a=e[0],i=e[1];return t(this.identifier(a)).html(i)},pie:function(e){for(var a=e.data("settings"),i=this.svg(e,a),n=e.data("graph-data"),s=0,r=[],o=0,d=t(this.identifier(e)).width()-4,h=0;h<n.length;h++)s+=n[h].value;for(h=0;h<n.length;h++)r[h]=n[h].value/s*Math.PI*2;for(h=0;h<n.length;h++){var c=o+r[h],u=d/2,p=d/2,f=d/2*.85;if(!a.donut){var l=u+f*Math.sin(o),m=p-f*Math.cos(o),v=u+f*Math.sin(c),g=p-f*Math.cos(c),_=0;c-o>Math.PI&&(_=1);var M="M"+u+","+p+" L"+l+","+m+" A"+f+","+f+" 0 "+_+" 1 "+v+","+g+" Z"}var y,x=t('path[data-id="s'+h+'"]',i.node);y=x.length>0?Snap(x[0]):i.path();var b=n[h].value/s*100,A=t('text[data-id="s'+h+'"]',i.node);if(A.length>0){var R=Snap(A[0]);R.attr({x:u+(f+a.percent_offset)*Math.sin(o+r[h]/2),y:p-(f+a.percent_offset)*Math.cos(o+r[h]/2)})}else R=y.paper.text(u+(f+a.percent_offset)*Math.sin(o+r[h]/2),p-(f+a.percent_offset)*Math.cos(o+r[h]/2),Math.ceil(b)+"%");var z=R.getBBox().width/2;R.attr({x:R.attr("x")-z,opacity:0}),R.node.setAttribute("data-id","s"+h),y.node.setAttribute("data-cx",u),y.node.setAttribute("data-cy",p),a.donut?this.annular_sector(y.node,{centerX:u,centerY:p,startDegrees:o,endDegrees:c,innerRadius:f*a.donut_inner_ratio,outerRadius:f}):y.attr({d:M}),y.attr({fill:n[h].color,stroke:a.stroke_color,strokeWidth:a.stroke_width}),y.node.setAttribute("data-id","s"+h),this.animate(y,u,p,a),o=c}return[e,i.node]},animate:function(e,a,i,n){e.hover(function(e){var s=Snap(e.target),r=Snap(t(s.node).parent().find('text[data-id="'+s.node.getAttribute("data-id")+'"]')[0]);s.animate({transform:"s1.05 1.05 "+a+" "+i},n.animation_speed,mina[n.animation_type]),r.touchend(function(){s.animate({transform:"s1.05 1.05 "+a+" "+i},n.animation_speed,mina[n.animation_type])}),n.show_percent&&(r.animate({opacity:1},n.animation_speed),r.touchend(function(){r.animate({opacity:1},n.animation_speed)}))},function(e){var s=Snap(e.target),r=Snap(t(s.node).parent().find('text[data-id="'+s.node.getAttribute("data-id")+'"]')[0]);s.animate({transform:"s1 1 "+a+" "+i},n.animation_speed,mina[n.animation_type]),r.animate({opacity:0},n.animation_speed)})},svg:function(e,a){var i=t(this.identifier(e)),n=t("svg",i),s=i.width(),r=s;return n=n.length>0?Snap(n[0]):Snap(s,r),n.node.setAttribute("width",s+a.percent_offset),n.node.setAttribute("height",r+a.percent_offset),n.node.setAttribute("viewBox","-"+a.percent_offset+" -"+a.percent_offset+" "+(s+1.5*a.percent_offset)+" "+(r+1.5*a.percent_offset)),n},annular_sector:function(t,e){function a(t){var e={cx:t.centerX||0,cy:t.centerY||0,startRadians:t.startDegrees||0,closeRadians:t.endDegrees||0},a=t.thickness!==i?t.thickness:100;return t.innerRadius!==i?e.r1=t.innerRadius:t.outerRadius!==i?e.r1=t.outerRadius-a:e.r1=200-a,t.outerRadius!==i?e.r2=t.outerRadius:e.r2=e.r1+a,e.r1<0&&(e.r1=0),e.r2<0&&(e.r2=0),e}var n=a(e),s=[[n.cx+n.r2*Math.sin(n.startRadians),n.cy-n.r2*Math.cos(n.startRadians)],[n.cx+n.r2*Math.sin(n.closeRadians),n.cy-n.r2*Math.cos(n.closeRadians)],[n.cx+n.r1*Math.sin(n.closeRadians),n.cy-n.r1*Math.cos(n.closeRadians)],[n.cx+n.r1*Math.sin(n.startRadians),n.cy-n.r1*Math.cos(n.startRadians)]],r=n.closeRadians-n.startRadians,o=r%(2*Math.PI)>Math.PI?1:0,d=[];d.push("M"+s[0].join()),d.push("A"+[n.r2,n.r2,0,o,1,s[1]].join()),d.push("L"+s[2].join()),d.push("A"+[n.r1,n.r1,0,o,0,s[3]].join()),d.push("z"),t.setAttribute("d",d.join(" "))},identifier:function(t){return"#"+t.data("pie-id")},throttle:function(t,e){var a=null;return function(){var i=this,n=arguments;clearTimeout(a),a=setTimeout(function(){t.apply(i,n)},e)}}};e.Pizza=n}($,this,this.document);